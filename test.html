<!DOCTYPE html>
<html>
<head>

</head><link rel="stylesheet" type="text/css" href="fullsort.css">
<body>
	<div id="d1"></div>
	<div id="d2"></div>
	<div id="d3"></div>
	<div id="d4"></div>
	<div id="d5"></div>
	<div id="d6"></div>
	<div id="d7"></div>
	<div id="d8"></div>
	<div id="d9"></div>
	<div id="d10"></div>

<script>
function getLocalKeys() {
	var contacts_list = [], i, key;
		for (i = 0; i < window.localStorage.length; i++) {
			key = window.localStorage.key(i);
			if (/Contacts:\d+/.test(key)) {
				contacts_list.push(JSON.parse(window.localStorage.getItem(key)));
			}
		}
		
console.log(111111111, contacts_list)		


	var sortOn = function(arr, prop, reverse, numeric) {

		//emsure there is a property
		if (!prop || !arr) {
			return arr;
		}
		//set up sort function
		var sort_by = function (field, rev, primer) {
			//return the required a,b function
			return function(a, b) {
				//reset a, b to the field
				a = primer(a[field]),
				b = primer(b[field]);
				//do actual sorting, reverse as needed
				return ((a < b) ? -1 : ((a > b) ? 1 : 0)) * (rev ? -1 : 1);
			}
		}
	// distingush between numberic and string to prevent 100s from coming before smaller
	//20
	// 1
	// 20
	// 3
	// 4000
	// 50

	if (numeric) {
		//do sort "in place" with sort_by function
		arr.sort(sort_by(prop, reverse, function(a) {
			//force value to a string.
			//replace any non numeric characters.
			//parse as float to allow 0.02 values
			return parseFloat(String(a).replace(/[^0-9.-]+/g, ''));
		}));
	} else {
		//do sort "in place" with sort_by function
		arr.sort(sort_by(prop, reverse, function(a){
			// - force value to string.
			return String(a).toUpperCase();
		}));
	}

	}

	function stringResult(elemID, doing, label) {
    var elem = document.getElementById(elemID);
    var result = "<p>" + label + "</p>";   
    result += '<table cellpadding="10" cellspacing="5">';
    
    for (var i = 0; i < contacts_list.length; i++) {
        result += "<tr>";
        result += '<td class="' + (doing == "id" ? "hot" : "cold") + '">';
        result += contacts_list[i].id + "</td>";
        
        result += '<td class="' + (doing == "city" ? "hot" : "cold") + '">';
        result += contacts_list[i].city + "</td>";
        
        result += '<td class="' + (doing == "state" ? "hot" : "cold") + '">';
        result += contacts_list[i].state + "</td>";
    }

    result += "</table>";
    result += "<br/>";   
    elem.innerHTML += result;

	}
	// Sort ID
	sortOn(contacts_list, 'id', false, true);
	stringResult("d1", 'id', "ID numeric");

	sortOn(contacts_list, 'id', true, true);
	stringResult("d2", 'id', "ID reverse numeric");


	// Sort CITY
	sortOn(contacts_list, 'city', false, false);
	stringResult("d3", 'city', "CITY");

	sortOn(contacts_list, 'city', true, false);
	stringResult("d4", 'city', "CITY reverse");


	// Sort STATE
	sortOn(contacts_list, 'state', false, false);
	stringResult("d5", 'state', "STATE");

	sortOn(contacts_list, 'state', true, false);
	stringResult("d6", 'state', "STATE reverse");
}getLocalKeys()
    
</script>
</body>
</html>